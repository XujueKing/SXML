<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- 安全策略 (CSP) - 临时允许内联样式和脚本以兼容现有代码 -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://api.example.com wss://api.example.com https://ipapi.co https://api.ipify.org; base-uri 'self'; form-action 'self';">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
  
  <meta name="theme-color" content="#000">
  <meta name="sxml-compiled" content="true">
  <!-- 防止缓存 -->
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>Your App Management Entrance</title>
  
  <!-- 连接优化：预解析与预连接，降低握手延迟 -->
  <link rel="dns-prefetch" href="//api.example.com" />
  <link rel="preconnect" href="https://api.example.com" crossorigin />
  <link rel="dns-prefetch" href="//ipapi.co" />
  <link rel="preconnect" href="https://ipapi.co" crossorigin />
  <link rel="dns-prefetch" href="//api.ipify.org" />
  <link rel="preconnect" href="https://api.ipify.org" crossorigin />
  
  <!-- 预加载关键CSS，防止FOUC（无样式内容闪烁）-->
  <link rel="preload" href="../../css/element.css" as="style" />
  <link rel="stylesheet" type="text/css" href="../../css/element.css" />
  <link rel="preload" href="./login.css" as="style" />
  <link rel="stylesheet" type="text/css" href="./login.css" />
  <link rel="icon" href="../../images/logo1.png" type="image/x-icon" />
  
  <!-- 防止页面闪烁的内联关键CSS -->
  <style>
    /* 首屏淡入 */
    body { 
      opacity: 0; 
      transition: opacity 0.3s ease-in;
    }
    body.loaded { 
      opacity: 1; 
    }
    /* 仅隐藏需要替换文本内容的元素，避免把 input/button 等交互控件隐藏 */
    [data-i18n]:not(input):not(button):not(select):not(textarea),
    [data-i18n-html]:not(input):not(button):not(select):not(textarea) {
      visibility: hidden;
    }
    .i18n-ready [data-i18n],
    .i18n-ready [data-i18n-html] {
      visibility: visible;
    }
    /* Bot 检测拒绝访问样式 */
    .access-denied {
      padding: 50px;
      text-align: center;
    }
  </style>

  <style>
    html, body {
      font-family: 'Microsoft YaHei', 'PingFangSC-Regular', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(#4b4b4b 0%, #000000 100%);
    }
  </style>
</head>
<body>
<!-- SXML Compiled at 2025-11-02T21:21:02.810Z -->

<!-- 声明式风格的登录页面 -->
<div class="lang-switch">
    <label for="langSelect" class="visually-hidden" data-i18n-aria-label="ui.langSelect">Language Selection</label>
    <select id="langSelect" onchange="currentPage.changeLang(event)" data-lang-selector="true">
        <!-- 语言选择器：永远显示原生名称，不受翻译影响 -->
        <option value="en-US">English</option>
        <option value="zh-CN">中文</option>
    </select>
</div>
<div class="mainpage">
    <div class="H">
        <img src="../../images/logo1.png" class="logo-header" alt="Your App" data-i18n-alt="app.name" style="object-fit: contain;" >
        <span class="T1" data-i18n="header.titleHtml" data-i18n-html="true"></span>
    </div>
    <div class="H">
        <div class="canvas_style" id="canvasId" style="display:none;"></div>
        <label for="u" class="visually-hidden">Account / Mobile / Email</label>
        <input id="u" name="u" type="text" placeholder="Enter mobile/username/email" data-i18n-placeholder="login.placeholder.account" onfocus="currentPage.u_onfocus(event)" onblur="currentPage.u_onblur(event)" class="ime" />
        <label for="p" class="visually-hidden">Password</label>
        <input id="p" name="p" type="password" placeholder="Please enter the password" data-i18n-placeholder="login.placeholder.password" onfocus="currentPage.u_onfocus(event)" onblur="currentPage.u_onblur(event)" onkeydown="currentPage.login_onkeydown(event)" class="inputX" />
        <label for="k" class="visually-hidden">Digital Key</label>
        <input id="k" name="k" type="password" placeholder="digital key（Key）" data-i18n-placeholder="login.placeholder.key" maxlength="32" onfocus="currentPage.u_onfocus(event)" onblur="currentPage.u_onblur(event)" class="inputX" />
        <svg id="l" class="lockIcon" viewBox="0 0 1024 1024" onclick="currentPage.d_lock(event)" style="display:none;">
            <path d="M 512 88.704 L 149.312 239.424 v 225.088 c 0 54.528 9.536 107.328 28.672 158.72 a 516.48 516.48 0 0 0 202.24 253.696 A 460.8 460.8 0 0 0 512 936.256 a 460.928 460.928 0 0 0 131.712 -59.2 a 517.504 517.504 0 0 0 202.304 -253.76 a 451.52 451.52 0 0 0 28.672 -158.72 V 239.424 L 512 88.704 Z m 448 122.24 v 253.568 c 0 64.64 -11.328 127.424 -33.92 188.352 a 602.368 602.368 0 0 1 -235.52 295.36 A 548.544 548.544 0 0 1 512 1024 a 548.416 548.416 0 0 1 -178.56 -75.776 A 601.664 601.664 0 0 1 97.92 652.8 A 536.192 536.192 0 0 1 64 464.512 V 211.008 c 0 -17.28 10.368 -32.768 26.24 -39.36 L 495.68 3.328 a 42.752 42.752 0 0 1 32.768 0 l 405.312 168.32 c 15.936 6.592 26.304 22.144 26.304 39.36 Z M 460.8 564.416 L 699.712 320 L 768 389.76 L 460.8 704 L 256 494.528 l 68.288 -69.76 L 460.8 564.288 Z"></path>
        </svg>
        <div id="l2" class="T3" data-i18n="login.key.installed" style="display:none;">
            The current device has installed a secure encryption key. Click to log out and reload.
        </div>
    </div>
    <div class="H H1 " id="bottomStyle">
    <button onclick="currentPage.loginEvent(event)" id="but" data-i18n="login.button">LOGIN</button>
        <div class="T2">Copyright Reserved © Rainbow Haruko 2026</div>
        <div class="T2 Top">WEB 3.0 DEX SYSTEM</div>
    </div>
    <svg id="b_code" class="barcode" viewBox="0 0 75 75" onclick="currentPage.showQRCode(event)" style="display:none;">
        <path d="M67.875,68.125 L73.749999,68.125 73.749999,74 67.875,74 z M54.5,68.125 L60.375,68.125 60.375,74 54.5,74 z M14,54 L20.5,54 20.5,60.5 14,60.5 z M7,47 L7,67.5 27.5,67.5 27.5,47 z M41,40.625 L60.5,40.625 60.5,53.75 67.375,53.75 67.375,40.875 74.25,40.875 74.25,60.875 54.125,60.875 54.125,47.375 47.125,47.375 47.125,74.25 41,74.25 z M0.5,40.5 L34,40.5 34,74 0.5,74 z M54,14 L60.5,14 60.5,20.5 54,20.5 z M14,14 L20.5,14 20.5,20.5 14,20.5 z M47,7 L47,27.5 67.5,27.5 67.5,7 z M7,7 L7,27.5 27.5,27.5 27.5,7 z M40.5,0.5 L74,0.5 74,34 40.5,34 z M0.5,0.5 L34,0.5 34,34 0.5,34 z"></path>
    </svg>
    <svg id="b_code2" class="barcode" viewBox="0 0 1024 1024" onclick="currentPage.showMenu(event)" style="display:none;">
        <path d="M 147.012 430.89 c -44.791 0 -81.109 36.305 -81.109 81.11 c 0 44.779 36.317 81.108 81.109 81.108 c 44.792 0 81.109 -36.33 81.109 -81.108 c 0 -44.805 -36.316 -81.11 -81.11 -81.11 Z m 364.987 0 c -44.79 0 -81.108 36.305 -81.108 81.11 c 0 44.779 36.316 81.108 81.108 81.108 c 44.793 0 81.11 -36.33 81.11 -81.108 c 0 -44.805 -36.317 -81.11 -81.11 -81.11 Z m 364.988 0 c -44.79 0 -81.108 36.305 -81.108 81.11 c 0 44.779 36.316 81.108 81.108 81.108 s 81.109 -36.33 81.109 -81.108 c -0.002 -44.805 -36.318 -81.11 -81.109 -81.11 Z"></path>
    </svg>
    <img id="b_code3" src="../../images/witeCode.png" class="barcode2" onclick="currentPage.enterCode(event)" alt="QR code login" data-i18n-alt="login.alt.qrcode"  style="display:none;">
</div>

  <!-- 动态依赖库（根据页面实际使用智能引入）-->
    <script type="text/javascript" src="../../utils/jQuery_v3.js"></script>
    <script type="text/javascript" src="../../utils/aes.js"></script>
    <script type="text/javascript" src="../../utils/md5.js"></script>
    <!-- API 签名映射配置（必须在 config.js 之前加载）-->
    <script type="text/javascript" src="../../config/api-sign-map.js"></script>
    <script type="text/javascript" src="../../config/app.config.prod.js"></script>
    <script>window.APP_CONFIG_URL = '../../config/app.config.prod.js';</script>
    <script type="text/javascript" src="../../utils/config.js"></script>
    <script type="text/javascript" src="../../app.js"></script>
    <script type="text/javascript" src="../../utils/logger.js"></script>
    <script type="text/javascript" src="../../locales/zh-CN.js"></script>
    <script type="text/javascript" src="../../utils/i18n.js"></script>
    <script type="text/javascript" src="../../utils/sapi.js"></script>
    <script type="text/javascript" src="../../utils/toast.js"></script>
    <script>
      // 确保 Toast 可用（静默回退加载，不输出控制台日志）
      (function(){
        try {
          if (typeof window.ShowToast !== 'function') {
            fetch('../../utils/toast.js').then(function(r){return r.text();}).then(function(code){ try{ eval(code); }catch(_){ } }).catch(function(){ /* silent */ });
          }
        } catch(_) {}
      })();
    </script>
    <script type="text/javascript" src="../../utils/page.js"></script>
    <script type="text/javascript" src="../../utils/onload.js"></script>
    <script type="text/javascript" src="../../utils/qrcode.js"></script>
  <!-- 页面加载器 -->
    <script>window.SXML_PRECOMPILED = true;</script>
    <script type="text/javascript" src="../../utils/page.loader.js"></script>
    
  <!-- 页面加载完成后显示内容：优先等待 i18n 就绪，最多延迟 800ms -->
    <script>
      (function(){
        // 反爬虫检测：检测自动化工具特征
        function detectBot() {
          // 检测 Headless 浏览器
          if (navigator.webdriver) return true;
          
          // 检测 Puppeteer/Playwright
          if (window.navigator.plugins.length === 0) return true;
          
          // 检测常见爬虫 User-Agent
          const ua = navigator.userAgent.toLowerCase();
          const botPatterns = ['bot', 'crawl', 'spider', 'scrape', 'python', 'requests', 'urllib', 'scrapy', 'selenium', 'phantomjs'];
          if (botPatterns.some(pattern => ua.includes(pattern))) return true;
          
          // 检测不正常的屏幕尺寸
          if (screen.width === 0 || screen.height === 0) return true;
          
          // 检测缺少常见浏览器对象
          if (!window.chrome && !window.safari && !window.opera && !/firefox/i.test(ua)) {
            if (!/edge/i.test(ua) && !/msie|trident/i.test(ua)) return true;
          }
          
          return false;
        }
        
        // 生成设备指纹
        function generateFingerprint() {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          ctx.textBaseline = 'top';
          ctx.font = '14px Arial';
          ctx.fillText('browser fingerprint', 2, 2);
          return canvas.toDataURL().slice(-50);
        }
        
        // 如果检测到机器人，隐藏内容或重定向
        if (detectBot()) {
          document.body.innerHTML = '<div class="access-denied"><h1>Access Denied</h1><p>Automated access is not allowed.</p></div>';
          console.error('Bot detected');
          return;
        }
        
        // 生成并存储设备指纹（用于后端验证）
        try {
          const fp = generateFingerprint();
          sessionStorage.setItem('_dfp', fp);
        } catch (e) { /* ignore */ }
        
        function reveal(){
          if (!document.body.classList.contains('loaded')) {
            document.body.classList.add('loaded');
          }
        }
        // 若 i18n 存在，等待其就绪事件，确保翻译文本已应用再显示
        if (window.i18n) {
          if (document.documentElement.classList.contains('i18n-ready')) {
            reveal();
          } else {
            window.addEventListener('i18n:ready', reveal, { once: true });
            // 兜底：若 800ms 内未就绪也先显示，避免白屏过久
            setTimeout(reveal, 800);
          }
        } else {
          // 无 i18n 时按 DOMContentLoaded 或立即显示
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', reveal);
          } else {
            reveal();
          }
        }
      })();
    </script>
</body>
</html>